function cookiesEnabled(){var e=navigator.cookieEnabled;if(e===!1)return!1;if(!document.cookie&&(e===null||!1)){document.cookie="testcookie=1";if(!document.cookie)return!1;document.cookie="testcookie=; expires="+(new Date(0)).toUTCString()}return!0}module=function(){var e=io.connect("http://localhost:3000/",{query:"sid="+$("#sid").attr("data-sid")});return{socket:e}}();var selected_tag=-1;updateChatTimes=function(){$.each($(".chat_time"),function(e,t){$(this).text(moment.utc($(this).attr("id")).fromNow())}),$(".last_login").length&&$(".last_login").html("<strong>Last login: </strong>"+moment.utc($(".last_login").attr("id")).fromNow())},updateTimes=function(){$.each($(".time"),function(e,t){$(this).text(moment.utc($(this).attr("id")).fromNow())})},$(document).ready(function(){updateChatTimes(),updateTimes(),setInterval(updateTimes,6e4),setInterval(updateChatTimes,6e4),$(".chat_status_indicator").tooltip(),$(".advanced_cog").tooltip(),$(".mssg_upvote").on("click",upvoteMssg),$(".mssg_downvote").on("click",downvoteMssg);var e=$("#reply_form").clone();$("a#advanced_create").click(function(e){return $("#advanced_modal").modal(),!1}),$(".reply_link").on("click",function(){return $("#message_"+$(this).attr("data-mssg-id")).find("#reply_form_"+$(this).attr("data-mssg-id")).length?($("#message_"+$(this).attr("data-mssg-id")).find("#reply_form_"+$(this).attr("data-mssg-id")).toggle(),$(this).children().text()=="Reply"?$(this).children().text("Cancel"):$(this).children().text("Reply")):($(this).html("<strong>Cancel</strong>"),$("#message_"+$(this).attr("data-mssg-id")).append(e),$("#message_"+$(this).attr("data-mssg-id")).find("#reply_form").attr("id","reply_form_"+$(this).attr("data-mssg-id")),$("#reply_form_"+$(this).attr("data-mssg-id")).children("#reply_to").val($(this).attr("data-mssg-id")),e=$("#reply_form").clone()),!1})}),$("#login_form").submit(function(){var e=1,t=$("#username").val(),n=$("#pass").val(),r=$("#pass2").val();$(".form-group").attr("class","form-group");if(t.length<3||t.length>20)$("#user_group").attr("class","form-group has-error"),$("#username").attr("data-original-title","Username must be longer than 2 characters but less than 15"),$("#username").tooltip("show"),e=0;else if(r!=""){var i=$.ajax({type:"GET",data:{username:t},url:"//mutualcog.com/profile/check-user",async:!1}).responseText;if(i==1){var i=$.ajax({type:"GET",data:{username:t},url:"//mutualcog.com/profile/check-alpha",async:!1}).responseText;i!=1&&($("#user_group").attr("class","form-group has-error"),$("#username").attr("data-original-title","Your username must contain at least one character"),$("#username").tooltip("show"),e=0)}else $("#user_group").attr("class","form-group has-error"),$("#username").attr("data-original-title","That username already exists"),$("#username").tooltip("show"),e=0}else{var i=$.ajax({type:"GET",data:{username:t,pass:n},url:"//mutualcog.com/profile/check-credentials",async:!1}).responseText;console.log(i),i!=1&&($("#user_group").attr("class","form-group has-error"),$("#pass1_group").attr("class","form-group has-error"),$("#username").attr("data-original-title","Your username or password is incorrect"),$("#username").tooltip("show"),e=0)}if(n.length<6||n.length>30)$("#pass1_group").attr("class","form-group has-error"),$("#pass2_group").attr("class","form-group has-error"),$("#pass").tooltip("show"),e=0;return n!=r&&r!=""&&($("#pass1_group").attr("class","form-group has-error"),$("#pass2_group").attr("class","form-group has-error"),$("#pass2").tooltip("show"),e=0),e?!0:!1}),$("#home_form").submit(function(){if(cookiesEnabled()){var e=1,t=$("#Title").val(),n=$("#Tags").val();$(".form_error").hide(),$(".form-group").attr("class","form-group");if(t.length<3||t.length>180)$("#Title").attr("data-original-title","Title must be longer than 2 characters but less than 180"),$("#Title").tooltip("show"),$("#title_group").attr("class","form-group has-error"),e=0;return n.split(" ")[0]==""||n.split(" ").length>5?($("#tags_group").attr("class","form-group has-error"),$("#Tags").attr("data-original-title","Must have at least 1 tag but less than 6"),$("#Tags").tooltip({placement:"left",trigger:"focus"}),$("#Tags").tooltip("show"),e=0):(n=n.split(" "),$.each(n,function(t,n){n=n.substr(1);if((n.length<3||n.length>19)&&n.length!=0)return $("#tags_group").attr("class","form-group has-error"),$("#Tags").attr("data-original-title","Tags must be longer than 2 characters but less than 20"),$("#Tags").tooltip({placement:"left",trigger:"focus"}),$("#Tags").tooltip("show"),e=0,!1})),e?($("#home_form").append('<input type="hidden" name="js_key" value="js_enabled" id="js_key">'),!0):!1}return $("#Title").attr("data-original-title","You must enable cookies to post chats"),$("#Title").tooltip("show"),!1}),$("#home_form_v2").submit(function(){if(cookiesEnabled()){var e=1,t=$("#Title_v2").val(),n=$("#Tags_v2").val();$(".form_error").hide(),$(".form-group").attr("class","form-group");if(t.length<3||t.length>180)$("#Title_v2").attr("data-original-title","Title must be longer than 2 characters but less than 180"),$("#Title_v2").tooltip("show"),$("#title_group_v2").attr("class","form-group has-error"),e=0;return n.split(" ")[0]==""||n.split(" ").length>5?($("#tags_group_v2").attr("class","form-group has-error"),$("#Tags_v2").attr("data-original-title","Must have at least 1 tag but less than 6"),$("#Tags_v2").tooltip({placement:"bottom",trigger:"focus"}),$("#Tags_v2").tooltip("show"),e=0):(n=n.split(" "),$.each(n,function(t,n){n=n.substr(1);if((n.length<3||n.length>19)&&n.length!=0)return $("#tags_group_v2").attr("class","form-group has-error"),$("#Tags_v2").attr("data-original-title","Tags must be longer than 2 characters but less than 20"),$("#Tags_v2").tooltip({placement:"bottom",trigger:"focus"}),$("#Tags_v2").tooltip("show"),e=0,!1})),e?($("#home_form_v2").append('<input type="hidden" name="js_key" value="js_enabled" id="js_key">'),!0):!1}return $("#Title").attr("data-original-title","You must enable cookies to post chats"),$("#Title").tooltip("show"),!1}),$(".big_upvote").click(function(e){e.stopPropagation();var t=$(this).attr("id"),n=$(this).attr("id").replace("upvote_",""),r="//mutualcog.com/chat/upvote";$.ajax({type:"POST",data:{id:n},url:r,success:function(e){e.status==1||e.status==3?($("#votes_"+n).text(e.upvotes),$("#upvote_"+n).css("color","#57bf4b"),$("#downvote_"+n).css("color","")):e.status==2?($("#votes_"+n).text(e.upvotes),$("#upvote_"+n).css("color",""),$("#downvote_"+n).css("color","")):$("#"+t).tooltip("show")},error:function(){}})}),$(".big_downvote").click(function(e){e.stopPropagation();var t=$(this).attr("id"),n=$(this).attr("id").replace("downvote_",""),r="//mutualcog.com/chat/downvote";$.ajax({type:"POST",data:{id:n},url:r,success:function(e){e.status==1||e.status==3?($("#votes_"+n).text(e.upvotes),$("#downvote_"+n).css("color","red"),$("#upvote_"+n).css("color","")):e.status==2?($("#votes_"+n).text(e.upvotes),$("#upvote_"+n).css("color",""),$("#downvote_"+n).css("color","")):$("#"+t).tooltip("show")},error:function(){}})}),upvoteMssg=function(e){e.stopPropagation();var t=$(this).attr("id").replace("mssg_upvote_",""),n="//mutualcog.com/chat/message-upvote";$.ajax({type:"POST",data:{id:t},url:n,success:function(e){e.status==1||e.status==3?($("#mssg_upvote_"+t).css("color","#57bf4b"),$("#mssg_downvote_"+t).css("color",""),$("#mssg_votes_"+t).text(e.upvotes)):e.status==2?($("#mssg_upvote_"+t).css("color",""),$("#mssg_downvote_"+t).css("color",""),$("#mssg_votes_"+t).text(e.upvotes)):$("#mssg_upvote_"+t).tooltip("show")},error:function(){}})},downvoteMssg=function(e){e.stopPropagation();var t=$(this).attr("id").replace("mssg_downvote_",""),n="//mutualcog.com/chat/message-downvote";$.ajax({type:"POST",data:{id:t},url:n,success:function(e){e.status==1||e.status==3?($("#mssg_downvote_"+t).css("color","red"),$("#mssg_upvote_"+t).css("color",""),$("#mssg_votes_"+t).text(e.upvotes)):e.status==2?($("#mssg_upvote_"+t).css("color",""),$("#mssg_downvote_"+t).css("color",""),$("#mssg_votes_"+t).text(e.upvotes)):$("#mssg_downvote_"+t).tooltip("show")},error:function(){}})},$("#tag_dropdown").on("click",function(e){e.stopPropagation()}),$("#search_input").on("focus",function(e){e.stopPropagation(),$("#search_input").val()==""&&$("#tag_dropdown").html(""),$(this).dropdown(),$("#tag_dropdown").show()}),$(window).on("click",function(e){$("#tag_dropdown").hide()});var selected_term=-1;$("#search_input").on("keydown",function(e){if(e.keyCode==13)return selected_term!=-1&&location.assign($("li#search_"+selected_term).children("a").attr("href")),!1;if(e.keyCode==38)return selected_term!=0&&(selected_term--,$(".tag_results").css("background-color",""),$("li#search_"+selected_term).css("background-color","#f5f5f5")),!1;if(e.keyCode==40)return selected_term!=$("#tag_dropdown").length&&(selected_term++,$(".tag_results").css("background-color",""),$("li#search_"+selected_term).css("background-color","#f5f5f5")),!1}),$("#search_input").on("keyup",function(e){var t=$(this).val();if(e.keyCode==13)return!1;e.keyCode!=38&&e.keyCode!=40&&(t.length>2?$.ajax({type:"GET",data:{tag:t},url:"//mutualcog.com/tags/similar-tag",success:function(e){var t="";$.each(e,function(e,n){t+='<li id="search_'+e+'" class="tag_results"><a href="//mutualcog.com/t/'+n.name+'">'+n.name+"</a></li>"}),t?($("#tag_dropdown").show(),$("#tag_dropdown").html()!=t&&($("#tag_dropdown").html(t),selected_term=-1)):($("#tag_dropdown").hide(),selected_term=-1)},error:function(){}}):$("#tag_dropdown").html(""))}),$(".tags_input").on("keydown",function(e){if(e.keyCode==13){if(selected_tag!=-1){var t=$(this).val().split(" ");return t.pop(),t.push("#"+$(".suggested_tags").eq(selected_tag).text()),$(this).val(t.join(" ")+" #"),$(this).focus(),!1}return!1}if(e.keyCode==38){if($(".popover").length!=0)return selected_tag!=0?(selected_tag-=1,$(".suggested_tags").css("color",""),$(".suggested_tags").eq(selected_tag).css("color","#57bf4b")):(selected_tag=-1,$(".suggested_tags").css("color","")),!1}else if(e.keyCode==40&&$(".popover").length!=0)return selected_tag!=$(".suggested_tags").length-1&&(selected_tag+=1,$(".suggested_tags").css("color",""),$(".suggested_tags").eq(selected_tag).css("color","#57bf4b")),!1}),$(".tags_input").on("keyup",function(e){if(e.keyCode==32)if($(this).val().length==1)$(this).val("");else{var t=$(this).val().split(" "),n=new Array;$.each(t,function(e,t){t=t.replace("#",""),n.push("#"+t)}),$(this).val(n.join(" ")),$(this).popover("destroy"),selected_tag=-1}else if(e.keyCode!=38&&e.keyCode!=40){var r=$(this).val().split(" ");r=r.pop().replace("#","");if(r.length>2){var i=$(this);$(this).on("blur",function(){$(".popover").length&&$(this).popover("hide")}),$.ajax({type:"GET",data:{tag:r.slice(0,-1)},url:"//mutualcog.com/tags/similar-tag",success:function(e){var t="";$.each(e,function(e,n){t+='<div class="suggested_tags" id="'+n.id+'">'+n.name+"</div>"}),$(".popover").length==0?t&&(i.popover({html:!0}),i.attr("data-content",t),i.popover("show"),$(".suggested_tags").click(function(){var e=$(".tags_input").val().split(" ");e.pop(),e.push("#"+$(this).text()),i.val(e.join(" ")+" #"),i.focus(),i.popover("destroy"),selected_tag=-1}),selected_tag=-1):t?$(".popover-content").html()!=t&&($(".popover-content").html(t),selected_tag=-1,$(".suggested_tags").off("click"),$(".suggested_tags").click(function(){var e=$(".tags_input").val().split(" ");e.pop(),e.push("#"+$(this).text()),i.val(e.join(" ")+" #"),i.focus(),i.popover("destroy"),selected_tag=-1})):(i.popover("destroy"),selected_tag=-1)},error:function(){}})}else $(this).popover("destroy"),selected_tag=-1}})