{% extends 'info_header.twig' %}

{% block content %}
<h1 class="profile_name" id="{{profile.id}}" style="margin-top:0px;">{{profile.name}}</h1>
{% if logged_in and profile.id != user.id and friended == 0 %}
	<a class="btn btn-primary add_friend" href="{{site}}/profile/friend/{{profile.id}}"><div class="glyphicon glyphicon-plus"></div> Add Friend</a>
{% elseif friended == 1 %}
	<a class="btn btn-danger add_friend" href="{{site}}/profile/unfriend/{{profile.id}}"><div class="glyphicon glyphicon-minus"></div> Remove Friend</a>
{% endif %}
<div>Posts: {{profile.posts | length}}</div>
<div>Comments: {{profile.messages | length}}</div>
<div>Level: {{profile.level}}</div>
<div>Cognizance: {{profile.cognizance}}/{{100 + 20*profile.level}}
<div class="progress progress-striped active">
	<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{profile.cognizance}}" aria-valuemin="0" aria-valuemax="{{100 + 20*profile.level}}" style="width:{{profile.cognizance}}%;">
		<span class="sr-only">Only {{profile.cognizance}}% Complete</span>
	</div>
</div>
<ul id="profileTabs" class="nav nav-tabs nav-justified">
	<li class="active"><a href="#about" data-toggle="tab" style="color:#075de9">About Me</a></li>
	<li><a href="#posts" data-toggle="tab" style="color:#075de9">Posts</a></li>
	<li><a href="#comments" data-toggle="tab" style="color:#075de9">Comments</a></li>
	<li><a href="#friendships" data-toggle="tab" style="color:#075de9">Friendships</a></li>
</ul>

<div id="tab_content" class="tab-content">

<div class="tab-pane fade active in" id="about">
	<div style="height:620px;margin-top:10px;">
	</div>
</div>

<div class="tab-pane fade in" id="posts">
	<div class="frame" style="height:620px;">
		<div id="chat_list">
			{% for post in profile.posts %}
				<div class="chat_title" style="box-shadow: 2px 0px 2px #ccc;">
					<div class="row">
						<div class="vote_box">
							{% if post.id in upvoted %}
								<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{post.id}}" style="color:#57bf4b" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							{% else %}
								<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{post.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							{% endif %}
							<div style="margin-top:-5px;margin-bottom:-8px;text-align:center;" id="votes_{{post.id}}">{{post.upvotes}}</div>
							{% if post.id in downvoted %}
								<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{post.id}}" style="color:red;" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
							{% else %}
								<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{post.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
							{% endif %}
						</div>
						<div class="col-lg-11">
							{% if post.link %}
								<a href="{{chat.link}}" style="color:#032f75;">{{post.title}}</a> <span class="site_name">from {{post.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{post.type}}/{{post.id}}" style="color:#032f75;">{{post.title}}</a>
							{% endif %}
							{% if post.admin_id != -1 %}
								<div class="chat_info">Created by <a href="{{site}}/p/{{post.admin}}" style="color:gray;"><b>{{post.admin}}</b></a>, 
							{% else %}
								<div class="chat_info">Created by <b>{{post.admin}}</b>, 
							{% endif %}
								<span class="chat_time" id="{{post.inception}}"></span>
								with Tags:
								{% for tag in post.tags %}
									<span class="chat_tags"><a href="{{site}}/t/{{tag.name}}" style="color:#075de9;">#{{tag.name}}</a> </span>
								{% endfor %}
								and <a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:gray;"><b>{{post.messages | length }} comments</b></a>
							</div>
						</div>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>
</div>

<div class="tab-pane fade in" id="comments">
	<div class="frame" id="chat_messages" style="height:620px;">
		<div id="chat_display">
			{% for message in profile.messages %}
				<div class='chat_mssg' id="{{message.id}}">
					<div class="chat_id_{{message.id}}" id="{{message.chat_id}}">
					<b class='mssg_op' id="{{message.author}}" style="color:{{color_arr[message.serial % 7]}}"> {{message.author}} (<span class='response_count' id="{{message.id}}">{{message.responses}}</span>)</b> : {{message.message | raw}}</div><div class='time' id="{{message.inception}}">
					</div>
				</div>
			{% endfor %}
		</div>
	</div>
</div>

<div class="tab-pane fade in" id="friendships">
	<div class="frame" style="height:620px;">
		{% for interaction in interactions %}
			<div>
				{{interaction.name}}
			</div>
		{% endfor %}
		{% for interaction in interacted %}
			<div class="col-lg-3 interaction">
				<a href="{{site}}/p/{{interaction.name}}" style="color:white;"><b>{{interaction.name}}</b></a>
				<div style="font-size:14px;">
					<div>Bond : {{interaction.pivot.bond}}</div>
					<div>Last Interaction : <span class="interaction_time" id="{{interaction.pivot.updated_at}}"></span></div>
				</div>
			</div>
		{% endfor %}
	</div>
</div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{base}}/app/libraries/js/profile.min.js"></script>
{% endblock %}
