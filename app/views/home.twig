{% extends 'home_layout.twig' %}

{% block header %}
<nav class="navbar">
	<div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mutual_navbar">
		<span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		<span class="icon-bar"></span>
		</button>
		<a class="{{home_active}} navbar-brand" href="{{site}}">Home</a>
	</div>
	<div class="collapse navbar-collapse" id="mutual_navbar" style="position:relative;">
		<form class="navbar-form tag_search" role="search">
			<div class="form-group dropdown">
				<input class="form-control tag_input" id="search_input" type="text" placeholder="Search Tags" autocomplete="off">
				<ul class="dropdown-menu" id="tag_dropdown" role="menu" aria-labelledby="search_input">
				</ul>
			</div>
		</form>
		{% if logged_in %}
		<ul class="nav navbar-nav nav_left">
			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown">Subscriptions <strong class="caret" style="color:white;"></strong></a>
				<ul class="dropdown-menu" role="menu">
					{% for sub in user.subscriptions %}
						<li><a href="{{site}}/t/{{sub.name}}">{{sub.name}}</a></li>
					{% endfor %}
				</ul>
			</li>
		</ul>
		<ul class="nav navbar-nav nav_right nav_margin">
			{% for tag in tags %}
				{% if curr_tag.name == tag.name %}
					<li><a class="highlight_light_blue" href="{{site}}/t/{{tag}}">{{tag}}</a></li>
				{% else %}
					<li><a href="{{site}}/t/{{tag}}">{{tag}}</a></li>
				{% endif %}
			{% endfor %}
		</ul>
		{% else %}
		<ul class="nav navbar-nav nav_right">
			{% for tag in tags %}
				{% if curr_tag.name == tag.name %}
					<li><a class="highlight_light_blue" href="{{site}}/t/{{tag}}">{{tag}}</a></li>
				{% else %}
					<li><a href="{{site}}/t/{{tag}}">{{tag}}</a></li>
				{% endif %}
			{% endfor %}
		</ul>
		{% endif %}
	</div>
</nav>
{% endblock %}

{% block welcome %}
<div style="margin-bottom:10px;">Welcome, {% if not user %}<span id="serial_tracker">{{serial}}</span>{% else %}<span id="user_tracker">{{user.name}}</span>{% endif %}</div>
{% if not logged_in %}
	<form method="post" action="{{site}}/profile/new-user" class="mutual_form" id="login_form">
	<fieldset>
		<div id="user_group" class="form-group">
			<input class="form-control" data-toggle="tooltip" data-placement="left" data-original-title="Username must be longer than 2 characters but less than 15" data-trigger="focus" data-container="body" type="text" name="username" id="username" placeholder="Enter your actual or preferred username">
		</div>
		<div id="pass1_group" class="form-group">
			<input class="form-control" data-toggle="tooltip" data-placement="left" data-original-title="Password must be longer than 6 characters but less than 30" data-trigger="focus" data-container="body" type="password" name="pass" id="pass" placeholder="Enter your password">
		</div>
		<div id="pass2_group" class="form-group">
			<input class="form-control" data-toggle="popover" data-original-title="Passwords don't match" data-container="body" data-placement="left" data-trigger="focus" type="password" name="pass2" id="pass2" placeholder="Enter password again to register">
		</div>
		<button class="btn btn-primary" type="Submit" style="width:100%;">Login/Register</button>
	</fieldset>
	</form>
{% else %}
	<div class="last_login" id="{{user.last_login}}"><strong>Last login:</strong></div>
	<div>Cognizance: {{user.cognizance}}/{{user.next_level}} (Level: {{user.level}})</div>
	<div class="progress progress-striped active">
		<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{user.cognizance}}" aria-valuemin="0" aria-valuemax="{{user.next_level}}" style="width:{{user.cognizance}}%;">
			<span class="sr-only">Only {{user.cognizance}}% Complete</span>
		</div>
	</div>
	<select class="form-control">
		<option value="">Visible and Evaluated</option>
	</select>
	<div class="welcome_btn_cont">
		<a class="btn btn-success btn_btm_l btn-sm" href="{{site}}/p/{{user.name}}">My Profile</a>
		<a class="btn btn-primary btn_btm_r btn-sm" href="{{site}}/profile/logout">Logout</a>
	</div>
{% endif %}
{% endblock %}

{% block create %}
<form method="post" action="{{site}}/chat/new-chat" class="mutual_form" id="home_form">
<fieldset>
	<legend>Create a new Chat</legend>
	<div id="title_group" class="form-group">
		<input class="form-control" data-toggle="tooltip" data-placement="left" data-original-title="Title must be longer than 2 characters but less than 180" data-trigger="focus" data-container="body" type="text" name="title" id="Title" placeholder="What's this chat about?">
	</div>
	<div id="link_group" class="form-group">
		<input class="form-control" type="text" name="link" id="Link" placeholder="Add a link (optional)">
	</div>
	<div id="tags_group" class="form-group">
		<input class="form-control" data-toggle="popover" data-content="<div>Some content</div>" data-original-title="Suggested Tags" data-container="body" data-placement="bottom" type="text" name="tags" id="Tags" placeholder="Use spaces to separate tags (max: 5)" autocomplete="off">
	</div>
	<button class="btn btn-primary" type="Submit" style="width:100%;">Create</button>
</fieldset>
</form>
{% endblock %}

{% block subscription %}
{% if not home_active %}
	<div class="content_right">
	<div class="content_left">
		<div class="small_content_box">
			<div class="content_left grad4"></div>
			<div class="content_right grad4"></div>
			<div class="content side_content" id="subscribe">
				<div><a href="{{site}}/t/{{curr_tag.name}}" style="font-size:22px;color:#333;"><strong>{{curr_tag.name}}</strong>{% if curr_tag.admin == user.name %} (Admin) {% endif %}</a></div>
				{% if logged_in %}
					{% if user_subscribed %}
						<span><a href="{{site}}/tags/unsubscribe/{{curr_tag.id}}" class="btn btn-danger btn-xs">Unsubscribe</a></span>
					{% else %}
						<span><a href="{{site}}/tags/subscribe/{{curr_tag.id}}" class="btn btn-success btn-xs">Subscribe</a></span>
					{% endif %}
				{% endif %}
				{% set tag_subscribers = curr_tag.subscribers | length %}
				<span>{{tag_subscribers}} Subscriber{% if tag_subscribers != 1 %}s{% endif %}</span>
				<div style="font-size:14px;"><div class="green_ball"></div> {{curr_tag.online}} online</div>
			</div>
		</div>
	</div>
	</div>
{% endif %}
{% endblock %}

{% block content %}
<div id="tab_content" class="tab-content">

<div class="tab-pane fade active in" id="hot">
	<div id="chat_list">
		{% for chat in chats %} 
			<div class="chat_title_box">
				<div class="row">
					<div class="number_box"> {{loop.index}}. </div>
					<div class="vote_box">
						{% if chat.id in upvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" style="color:#57bf4b" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% elseif chat.id in downvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" style="color:red;" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% else %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% endif %}
					</div>
					{% if chat.image %}
						<a class="pull-left link_thumbnail" href="{{chat.link}}">
							<img src="{{chat.image}}" alt="Image Error" width="80" height="80">
						</a>
					{% endif %}
					<div class="chat_title">
						{% if chat.seen %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:purple;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:purple;">{{chat.title}}</a>
							{% endif %}
						{% else %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:#032f75;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:#032f75;">{{chat.title}}</a>
							{% endif %}
						{% endif %}
						{% if chat.admin % 16777259 == 0 %}
							<div class="chat_info">Created by <a href="{{site}}/p/{{chat.admin}}" style="color:gray;"><strong>{{chat.admin}}</strong></a>, 
						{% else %}
							<div class="chat_info">Created by <strong>{{chat.admin}}</strong>, 
						{% endif %}
							<span class="chat_time" id="{{chat.created_at}}"></span>
							with Tags:
							{% for tag in chat.tags %}
								<span class="chat_tags"><a href="{{site}}/t/{{tag.name}}" style="color:#075de9;">#{{tag.name}}</a> </span>
							{% endfor %}
							and <a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:gray;"><strong>{{chat.messages | length }} comments</strong></a>
						</div>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>
	<div class="page_links">
		{{chats.links|raw}}
	</div>
	<div class="policy">
		<span style="margin-left:-104px;"><a href="{{site}}/privacy">Privacy Policy</a></span> |
		<span><a href="{{site}}/terms">Terms of Use</a></span>
	</div>
</div>

<div class="tab-pane fade in" id="new">
	<div id="chat_list">
		{% for chat in chats_new %} 
			<div class="chat_title_box">
				<div class="row">
					<div class="number_box"> {{loop.index}}. </div>
					<div class="vote_box">
						{% if chat.id in upvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" style="color:#57bf4b" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% elseif chat.id in downvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" style="color:red;" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% else %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% endif %}
					</div>
					{% if chat.image %}
						<a class="pull-left link_thumbnail" href="{{chat.link}}">
							<img src="{{chat.image}}" alt="Image Error" width="80" height="80">
						</a>
					{% endif %}
					<div class="chat_title">
						{% if chat.seen %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:purple;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:purple;">{{chat.title}}</a>
							{% endif %}
						{% else %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:#032f75;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:#032f75;">{{chat.title}}</a>
							{% endif %}
						{% endif %}
						{% if chat.admin % 16777259 == 0 %}
							<div class="chat_info">Created by <a href="{{site}}/p/{{chat.admin}}" style="color:gray;"><strong>{{chat.admin}}</strong></a>, 
						{% else %}
							<div class="chat_info">Created by <strong>{{chat.admin}}</strong>, 
						{% endif %}
							<span class="chat_time" id="{{chat.created_at}}"></span>
							with Tags:
							{% for tag in chat.tags %}
								<span class="chat_tags"><a href="{{site}}/t/{{tag.name}}" style="color:#075de9;">#{{tag.name}}</a> </span>
							{% endfor %}
							and <a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:gray;"><strong>{{chat.messages | length }} comments</strong></a>
						</div>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>
	<div class="page_links">
		{{chats_new.links|raw}}
	</div>
	<div class="policy">
		<span style="margin-left:-104px;"><a href="{{site}}/privacy">Privacy Policy</a></span> |
		<span><a href="{{site}}/terms">Terms of Use</a></span>
	</div>
</div>

<div class="tab-pane fade in" id="rising">
	<div id="chat_list">
		{% for chat in chats_rising %} 
			<div class="chat_title_box">
				<div class="row">
					<div class="number_box"> {{loop.index}}. </div>
					<div class="vote_box">
						{% if chat.id in upvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" style="color:#57bf4b" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% elseif chat.id in downvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" style="color:red;" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% else %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% endif %}
					</div>
					{% if chat.image %}
						<a class="pull-left link_thumbnail" href="{{chat.link}}">
							<img src="{{chat.image}}" alt="Image Error" width="80" height="80">
						</a>
					{% endif %}
					<div class="chat_title">
						{% if chat.seen %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:purple;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:purple;">{{chat.title}}</a>
							{% endif %}
						{% else %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:#032f75;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:#032f75;">{{chat.title}}</a>
							{% endif %}
						{% endif %}
						{% if chat.admin % 16777259 == 0 %}
							<div class="chat_info">Created by <a href="{{site}}/p/{{chat.admin}}" style="color:gray;"><strong>{{chat.admin}}</strong></a>, 
						{% else %}
							<div class="chat_info">Created by <strong>{{chat.admin}}</strong>, 
						{% endif %}
							<span class="chat_time" id="{{chat.created_at}}"></span>
							with Tags:
							{% for tag in chat.tags %}
								<span class="chat_tags"><a href="{{site}}/t/{{tag.name}}" style="color:#075de9;">#{{tag.name}}</a> </span>
							{% endfor %}
							and <a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:gray;"><strong>{{chat.messages | length }} comments</strong></a>
						</div>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>
	<div class="page_links">
		{{chats_rising.links|raw}}
	</div>
	<div class="policy">
		<span style="margin-left:-104px;"><a href="{{site}}/privacy">Privacy Policy</a></span> |
		<span><a href="{{site}}/terms">Terms of Use</a></span>
	</div>
</div>

<div class="tab-pane fade in" id="controversial">
	<div id="chat_list">
		{% for chat in chats_contr %} 
			<div class="chat_title_box">
				<div class="row">
					<div class="number_box"> {{loop.index}}. </div>
					<div class="vote_box">
						{% if chat.id in upvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" style="color:#57bf4b" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% elseif chat.id in downvoted %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" style="color:red;" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% else %}
							<span class="glyphicon glyphicon-chevron-up big_upvote" id="upvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="top"></span>
							<div style="margin-top:-5px;margin-bottom:-5px;text-align:center;" id="votes_{{chat.id}}">{{chat.upvotes - chat.downvotes}}</div>
							<span class="glyphicon glyphicon-chevron-down big_downvote" id="downvote_{{chat.id}}" data-toggle="tooltip" data-original-title="You must be logged in to vote on posts" data-container="body" data-placement="bottom"></span>
						{% endif %}
					</div>
					{% if chat.image %}
						<a class="pull-left link_thumbnail" href="{{chat.link}}">
							<img src="{{chat.image}}" alt="Image Error" width="80" height="80">
						</a>
					{% endif %}
					<div class="chat_title">
						{% if chat.seen %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:purple;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:purple;">{{chat.title}}</a>
							{% endif %}
						{% else %}
							{% if chat.link %}
								<a href="{{chat.link}}" style="color:#032f75;">{{chat.title}}</a> <span class="site_name">from {{chat.site_name}}</span>
							{% else %}
								<a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:#032f75;">{{chat.title}}</a>
							{% endif %}
						{% endif %}
						{% if chat.admin % 16777259 == 0 %}
							<div class="chat_info">Created by <a href="{{site}}/p/{{chat.admin}}" style="color:gray;"><strong>{{chat.admin}}</strong></a>, 
						{% else %}
							<div class="chat_info">Created by <strong>{{chat.admin}}</strong>, 
						{% endif %}
							<span class="chat_time" id="{{chat.created_at}}"></span>
							with Tags:
							{% for tag in chat.tags %}
								<span class="chat_tags"><a href="{{site}}/t/{{tag.name}}" style="color:#075de9;">#{{tag.name}}</a> </span>
							{% endfor %}
							and <a href="{{site}}/chat/{{chat.type}}/{{chat.id}}" style="color:gray;"><strong>{{chat.messages | length }} comments</strong></a>
						</div>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>
	<div class="page_links">
		{{chats_contr.links|raw}}
	</div>
	<div class="policy">
		<span style="margin-left:-104px;"><a href="{{site}}/privacy">Privacy Policy</a></span> |
		<span><a href="{{site}}/terms">Terms of Use</a></span>
	</div>
</div>

</div>
{% endblock %}

